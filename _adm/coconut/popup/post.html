<script type="text/template" id="tpl_popup_post">
    <div class="text-right">
        <button class="btn btn-link text-white" onclick="history.go(-1); return false;"><i class="fas fa-times fa-2x"></i></button>
    </div>
    <div class="card mt-3 noSwipe border-0">
        <div class="card-body">
            <form id="thePopupPostForm" class="form-horizontal">
                <div class="form-group row">
                    <label class="col-sm-2 control-label">기간</label>
                    <div class="col-sm-10">
                      <div class="btn-group">
                        <button type="button" class="btn btn-secondary btn-sm pop_term" data-term="1">1일</button>
                        <button type="button" class="btn btn-secondary btn-sm pop_term" data-term="3">3일</button>
                        <button type="button" class="btn btn-secondary btn-sm pop_term" data-term="7">7일</button>
                        <button type="button" class="btn btn-secondary btn-sm pop_term" data-term="10">10일</button>
                        <button type="button" class="btn btn-secondary btn-sm pop_term" data-term="15">15일</button>
                        <button type="button" class="btn btn-secondary btn-sm pop_term" data-term="30">30일</button>
                      </div>
                    </div>
                  </div>
                  <hr />
                <% 
                _.each(scheme, function(scheme_params, column_name)
                {
                    var column_type    = 'text';
                    var column_title   = '';
                    var column_default = {};
                    var column_comment = '';
                    var column_value   = '';
                    if(!_.isNull(scheme_params))
                    {
                        // type
                        if(!_.isUndefined(scheme_params.type)) {
                            column_type = scheme_params.type;
                        }

                        // title
                        if(!_.isUndefined(scheme_params.title)) {
                            column_title = scheme_params.title;
                        }

                        // default
                        if(!_.isUndefined(scheme_params.default)) {
                            column_default = scheme_params.default;
                        }

                        // value
                        if(!_.isUndefined(scheme_params.value)) {
                            column_value = scheme_params.value;
                        }

                        // comment
                        if(!_.isUndefined(scheme_params.comment)) {
                            column_comment = scheme_params.comment;
                        }
                    }
                    %>

                    <% if(column_type=='select'){ %>
                    <div class="form-group row">
                        <label for="<%-column_name%>" class="col-sm-2 control-label"><%-column_title%></label>
                        <div class="col-sm-10">
                            <select id="<%-column_name%>" name="<%-column_name%>" class="form-control" style="margin-bottom:5px;">
                                <option value="">+ <%-column_title%> 선택하세요.</option>
                                <%_.each(column_default, function(dtitle, dkey)
                                {
                                    var selected = (column_value==dkey) ? 'selected="selected"' : '';
                                %>
                                <option value="<%-dkey%>" <%=selected%>> 
                                    <%-dtitle%>
                                </option>
                                <%});%>
                            </select>
                        </div>
                    </div>
                    <%} else if(column_type=='radio'){ %>
                    <fieldset class="form-group border-0 px-0">
                        <div class="row">
                            <legend class="col-form-label col-sm-2 pt-0"><%-column_title%></legend>
                            <div class="col-sm-10">
                                <%
                                var ri = 1;
                                _.each(column_default, function(rtitle, rkey)
                                {
                                    var checked = (column_value==rkey) ? 'checked' : '';
                                %>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="<%-column_name%>" id="<%-column_name%><%-ri%>" value="<%-rkey%>" <%-checked%>>
                                    <label class="form-check-label" for="<%-column_name%><%-ri%>">
                                     <%-rtitle%>
                                    </label>
                                </div>
                                <%
                                    ri++;
                                });
                                %>
                            </div>
                        </div>
                    </fieldset>
                    <%} else if(column_type=='checkbox'){ %>
                    <div class="form-group">
                        <%
                        var ci = 1;
                        _.each(column_default, function(ctitle, ckey)
                        {
                            var checked = (column_value==ckey) ? 'checked' : '';
                        %>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="<%-ckey%>" name="<%-column_name%>" id="<%-column_name%><%-ci%>" required>
                            <label class="form-check-label" for="<%-column_name%><%-ci%>">
                            <%-ctitle%>
                            </label>
                        </div>
                        <%
                            ci++;
                        });
                        %>
                    </div>
                    <%} else if(column_type=='rolldate'){ %>
                    <div class="form-group row">
                        <label for="<%-column_name%>" class="col-sm-2 control-label"><%-column_title%></label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="<%-column_name%>" name="<%-column_name%>" placeholder="<%-column_comment%>" value="<%-column_value%>" readonly />
                        </div>
                        <%
                        require(['rolldate'],function(Rolldate){
                            new Rolldate({
                                el:'#'+column_name,
                                beginYear : 1935,
                                format : 'YYYY-MM-DD',
                                lang : {
                                    title: column_title,
                                    cancel: '취소',
                                    confirm: '확인',
                                    year: '년',
                                    month: '월',
                                    day: '일',
                                    hour: '시',
                                    min: '분',
                                    sec: '초'
                                }
                            });
                        });
                        %>
                    </div>
                    <%} else if(column_type=='datepicker'){ %>
                    <div class="form-group row">
                        <label for="<%-column_name%>" class="col-sm-2 control-label"><%-column_title%></label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="<%-column_name%>" name="<%-column_name%>" placeholder="<%-column_comment%>" value="<%-column_value%>" readonly />
                        </div>
                        <%
                        require(['datepicker/datepicker'], function(datepicker) 
                        {
                            datepicker.initialize(['#'+column_name],function(context){
                                app.log(context);
                            });
                        });
                        %>
                    </div>
                    <%} else if(column_type=='timepicker'){ %>
                    <div class="form-group row">
                        <label for="<%-column_name%>" class="col-sm-2 control-label"><%-column_title%></label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="<%-column_name%>" name="<%-column_name%>" placeholder="<%-column_comment%>" value="<%-column_value%>" readonly />
                        </div>
                        <%
                        require(['clockpicker', 'css!libs/css/clockpicker.min.css'], function(clockpicker) 
                        {
                            // 시작시간
                            $('#'+column_name).clockpicker({
                                placement: 'bottom',
                                align: 'right',
                                autoclose: true
                            });
                        });
                        %>
                    </div>
                    <%} else if(column_type=='wysiwyg'){ %>
                    <div class="form-group row">
                        <label for="<%-column_name%>" class="col-sm-2 control-label"><%-column_title%></label>
                        <div class="col-sm-10">
                            <textarea id="<%-column_name%>" name="<%-column_name%>" class="list-group-item form-control fu-input-text" style="width:100%;" placeholder="<%-column.title%>"><%-column.value%></textarea>
                        </div>
                        <%
                        require(["ckeditor"], function(ckeditor) {
                            $('#'+column_name).ckeditor({
                                customConfig : '/plugins/ckeditor/config.js',
                                skin:'moono-lisa'
                            });
                        });
                        %>
                    </div>
                    <%} else if(column_type=='textarea'){ %>
                    <div class="form-group row">
                        <label for="<%-column_name%>" class="col-sm-2 control-label"><%-column_title%></label>
                        <div class="col-sm-10">
                            <textarea id="<%-column_name%>" name="<%-column_name%>" class="list-group-item form-control fu-input-text" style="width:100%;" placeholder="<%-column.title%>"><%-column.value%></textarea>
                        </div>
                    </div>
                    <%} else if(column_type=='file'){ %>
                    <div class="form-group row fu-form-group">
                        <input type="hidden" class="form-control" id="<%-column_name%>" name="<%-column_name%>" value="<%-column_value%>" />
                        <label for="<%-column_name%>" class="col-sm-2 control-label"><%-column_title%></label>
                        <div class="col-sm-10">
                            <div id="uploadfiles_<%-column_name%>"></div>
                        </div>
                        <%
                        require(['core/uploadfiles.min'], function(UploadableActivity) {
                            UploadableActivity.initialize('#uploadfiles_'+column_name, scheme_params.doc_id, {
                                token : column_value,
                                dragDrop: 'true',
                                maxFileCount: scheme_params.number_files_allowed,
                                acceptFiles: scheme_params.default
                            });
                            UploadableActivity.run();
                        });
                        %>
                    </div>
                    <% } else { %>
                    <div class="form-group row">
                        <label for="<%-column_name%>" class="col-sm-2 control-label"><%-column_title%></label>
                        <div class="col-sm-10">
                            <input type="<%-column_type%>" class="form-control" id="<%-column_name%>" name="<%-column_name%>" placeholder="<%-column_comment%>" value="<%-column_value%>" />
                        </div>
                    </div>
                    <%}%>
                <%});%>
        
                <hr />

                <!--버튼-->
                <div class="text-center" style="padding: 20px 0px;">
                    <button type="submit" class="btn btn-primary btn-lg btn-block">저장하기</button>
                </div>
            </form>
        </div>
    </div>
</script>